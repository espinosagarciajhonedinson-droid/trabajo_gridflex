<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Timeline - Jhon</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- HEADER CON BÃšSQUEDA -->
    <header class="header">
        <div class="header-container">
            <div class="logo">
                <h1>ğŸ“± Social Network</h1>
            </div>
            <div class="search-bar">
                <input type="text" placeholder="ğŸ” Buscar..." class="search-input">
            </div>
            <div class="header-icons">
                <button class="icon-btn">ğŸ””</button>
                <button class="icon-btn">ğŸ’¬</button>
                <button class="icon-btn">ğŸ‘¤</button>
            </div>
        </div>
    </header>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="main-container">
        <!-- SIDEBAR IZQUIERDO - NAVEGACIÃ“N -->
        <aside class="sidebar-left" role="navigation">
            <div class="menu-section">
                <h3>Mi MenÃº</h3>
                <ul class="menu-list">
                    <li><a href="#" class="menu-item active">ğŸ“° Inicio</a></li>
                    <li><a href="#" class="menu-item">ğŸ‘¥ Amigos</a></li>
                    <li><a href="#" class="menu-item">ğŸ“¸ Fotos</a></li>
                    <li><a href="#" class="menu-item">ğŸ’¾ Guardados</a></li>
                    <li><a href="#" class="menu-item">âš™ï¸ ConfiguraciÃ³n</a></li>
                </ul>
            </div>

            <div class="menu-section">
                <h3>Comunidades</h3>
                <ul class="menu-list">
                    <li><a href="#" class="menu-item">ğŸ® Gaming</a></li>
                    <li><a href="#" class="menu-item">ğŸ‹ï¸ Fitness</a></li>
                    <li><a href="#" class="menu-item">ğŸ• Comida</a></li>
                    <li><a href="#" class="menu-item">âœˆï¸ Viajes</a></li>
                </ul>
            </div>
        </aside>

        <!-- CONTENIDO PRINCIPAL - FEED -->
        <main class="feed">
            <!-- CREAR POST -->
            <div class="create-post">
                <div class="user-profile">
                    <img src="imagenes/WhatsApp Image 2026-02-09 at 19.18.27.jpeg" alt="Tu perfil" class="profile-pic">
                    <input type="text" placeholder="Â¿En quÃ© estÃ¡s pensando?" class="post-input" id="postText">
                </div>
                <div class="post-actions">
                    <button class="post-btn" id="cameraBtn" title="Abrir cÃ¡mara">ğŸ“· Foto</button>
                    <button class="post-btn" id="galleryBtn" title="Subir archivo">ğŸ¨ GalerÃ­a</button>
                    <button class="post-btn" id="publishBtn" title="Publicar post">ğŸ“¤ Publicar</button>
                </div>
                <input type="file" id="galleryInput" accept="image/*" style="display: none;">
            </div>

            <!-- POST 1 -->
            <article class="post">
                <div class="post-header">
                <img src="imagenes/avatars/user1.jpg" alt="Usuario" class="profile-pic-small" onerror="this.style.display='none'">
                    <div class="post-info">
                        <h4>Jhon Espinosa</h4>
                        <span class="post-time">hace 2 horas</span>
                    </div>
                    <span class="post-menu">â‹¯</span>
                </div>
                
                <div class="post-content">
                    <p>Â¡Hoy fue un excelente dÃ­a de desarrollo! Acabo de terminar un proyecto con Grid y Flexbox. Â¿QuÃ© dicen ustedes de las nuevas tÃ©cnicas de CSS?</p>
                </div>

                <img src="imagenes/posts/post1.jpg" alt="Contenido del post" class="post-image clickable-image" onerror="this.src='imagenes/posts/post1.jpg';">
                <img src="imagenes/posts/post1.jpg" alt="Post 1" hidden>

                <div class="post-stats">
                    <span>ğŸ‘ 234 me gusta</span>
                    <span>ğŸ’¬ 45 comentarios</span>
                    <span>â†—ï¸ 12 compartidos</span>
                </div>

                <div class="post-actions-footer">
                    <button class="action-btn">ğŸ‘ Me gusta</button>
                    <button class="action-btn">ğŸ’¬ Comentar</button>
                    <button class="action-btn">â†—ï¸ Compartir</button>
                </div>

                <!-- COMENTARIOS -->
                <div class="comments-section">
                    <div class="comment">
                        <img src="imagenes/avatars/user2.jpg" alt="Comentario" class="comment-pic" onerror="this.style.display='none'">
                        <div class="comment-content">
                            <strong>Ana MarÃ­a</strong>
                            <p>Â¡Excelente trabajo! CSS ha evolucionado mucho.</p>
                            <span class="comment-time">hace 1 hora</span>
                        </div>
                    </div>
                    <div class="comment">
                        <img src="imagenes/avatars/user3.jpg" alt="Comentario" class="comment-pic" onerror="this.style.display='none'">
                        <div class="comment-content">
                            <strong>Carlos</strong>
                            <p>Me encanta cÃ³mo se ve. Â¿CuÃ¡l es tu fuente favorita?</p>
                            <span class="comment-time">hace 45 min</span>
                        </div>
                    </div>
                </div>

                <div class="comment-input">
                    <img src="imagenes/avatars/user2.jpg" alt="Tu foto" class="comment-pic" onerror="this.style.display='none'">
                    <input type="text" placeholder="Escribe un comentario..." class="comment-field">
                </div>
            </article>

            <!-- POST 2 -->
            <article class="post">
                <div class="post-header">
                    <img src="imagenes/avatars/user4.jpg" alt="Usuario" class="profile-pic-small" onerror="this.style.display='none'">
                    <div class="post-info">
                        <h4>MarÃ­a GonzÃ¡lez</h4>
                        <span class="post-time">hace 4 horas</span>
                    </div>
                    <span class="post-menu">â‹¯</span>
                </div>
                
                <div class="post-content">
                    <p>Â¡Compartiendo algunos consejos sobre diseÃ±o responsivo! ğŸ¨</p>
                </div>
                <img src="imagenes/posts/post2.jpg" alt="DiseÃ±o responsivo" class="post-image clickable-image" onerror="this.src='imagenes/posts/post2.jpg';">

                <div class="post-stats">
                    <span>ğŸ‘ 512 me gusta</span>
                    <span>ğŸ’¬ 89 comentarios</span>
                    <span>â†—ï¸ 45 compartidos</span>
                </div>

                <div class="post-actions-footer">
                    <button class="action-btn">ğŸ‘ Me gusta</button>
                    <button class="action-btn">ğŸ’¬ Comentar</button>
                    <button class="action-btn">â†—ï¸ Compartir</button>
                </div>
            </article>

            <!-- POST 3 -->
            <article class="post">
                <div class="post-header">
                    <img src="imagenes/avatars/user5.jpg" alt="Usuario" class="profile-pic-small" onerror="this.style.display='none'">
                    <div class="post-info">
                        <h4>Pedro RodrÃ­guez</h4>
                        <span class="post-time">hace 6 horas</span>
                    </div>
                    <span class="post-menu">â‹¯</span>
                </div>
                
                <div class="post-content">
                    <p>Les presento mi nuevo proyecto: Una plataforma de aprendizaje con Grid y Flexbox. El cÃ³digo es limpio y responsivo. Â¿QuÃ© les parece?</p>
                </div>

                <img src="imagenes/posts/post3.jpg" alt="Proyecto" class="post-image clickable-image" onerror="this.src='imagenes/posts/post3.jpg';">

                <div class="post-stats">
                    <span>ğŸ‘ 1.2K me gusta</span>
                    <span>ğŸ’¬ 234 comentarios</span>
                    <span>â†—ï¸ 567 compartidos</span>
                </div>

                <div class="post-actions-footer">
                    <button class="action-btn">ğŸ‘ Me gusta</button>
                    <button class="action-btn">ğŸ’¬ Comentar</button>
                    <button class="action-btn">â†—ï¸ Compartir</button>
                </div>
            </article>

            <!-- POST 4 -->
            <article class="post">
                <div class="post-header">
                    <img src="imagenes/avatars/user6.jpg" alt="Usuario" class="profile-pic-small" onerror="this.style.display='none'">
                    <div class="post-info">
                        <h4>Laura MartÃ­nez</h4>
                        <span class="post-time">hace 8 horas</span>
                    </div>
                    <span class="post-menu">â‹¯</span>
                </div>
                
                <div class="post-content">
                    <p>Â¡Nuevo dÃ­a, nuevas oportunidades! ğŸ’ª Trabajando en mejorar mis habilidades en CSS Grid.</p>
                </div>
                <img src="imagenes/posts/post4.jpg" alt="DÃ­a de trabajo" class="post-image clickable-image" onerror="this.src='imagenes/posts/post4.jpg';">

                <div class="post-stats">
                    <span>ğŸ‘ 789 me gusta</span>
                    <span>ğŸ’¬ 123 comentarios</span>
                    <span>â†—ï¸ 234 compartidos</span>
                </div>

                <div class="post-actions-footer">
                    <button class="action-btn">ğŸ‘ Me gusta</button>
                    <button class="action-btn">ğŸ’¬ Comentar</button>
                    <button class="action-btn">â†—ï¸ Compartir</button>
                </div>
            </article>
        </main>

        <!-- SIDEBAR DERECHO - WIDGETS -->
        <aside class="sidebar-right" role="complementary">
            <!-- SUGERENCIAS -->
            <div class="widget-box">
                <h3 class="widget-title">ğŸ‘¥ Sugerencias de amigos</h3>
                <div class="suggestion">
                    <img src="imagenes/avatars/user1.jpg" alt="Sugerencia" class="suggestion-pic" onerror="this.style.display='none'">
                    <div class="suggestion-info">
                        <h5>Diego LÃ³pez</h5>
                        <p>5 amigos en comÃºn</p>
                    </div>
                    <button class="add-btn">+</button>
                </div>
                <div class="suggestion">
                    <img src="imagenes/avatars/user5.jpg" alt="Sugerencia" class="suggestion-pic" onerror="this.style.display='none'">
                    <div class="suggestion-info">
                        <h5>Sofia Ruiz</h5>
                        <p>12 amigos en comÃºn</p>
                    </div>
                    <button class="add-btn">+</button>
                </div>
                <div class="suggestion">
                    <img src="imagenes/avatars/user7.jpg" alt="Sugerencia" class="suggestion-pic" onerror="this.style.display='none'">
                    <div class="suggestion-info">
                        <h5>Juan PÃ©rez</h5>
                        <p>8 amigos en comÃºn</p>
                    </div>
                    <button class="add-btn">+</button>
                </div>
            </div>

            <!-- EVENTOS -->
            <div class="widget-box">
                <h3 class="widget-title">ğŸ“… Eventos PrÃ³ximos</h3>
                <div class="event">
                    <span class="event-date">FEB 15</span>
                    <div class="event-info">
                        <h5>Conferencia de Web Design</h5>
                        <p>8:00 PM</p>
                    </div>
                </div>
                <div class="event">
                    <span class="event-date">FEB 20</span>
                    <div class="event-info">
                        <h5>Meetup de Desarrolladores</h5>
                        <p>6:30 PM</p>
                    </div>
                </div>
                <div class="event">
                    <span class="event-date">FEB 25</span>
                    <div class="event-info">
                        <h5>Hackathon CSS Challenge</h5>
                        <p>10:00 AM</p>
                    </div>
                </div>
            </div>

            <!-- PUBLICIDAD -->
            <div class="widget-box ad">
                <div class="ad-content">
                    <h4>ğŸš€ Curso Premium</h4>
                    <p>Aprende CSS avanzado en 30 dÃ­as</p>
                    <button class="ad-btn">Conocer mÃ¡s</button>
                </div>
            </div>

            <!-- ENLACE RÃPIDO -->
            <div class="widget-box">
                <h3 class="widget-title">ğŸ”— Enlaces RÃ¡pidos</h3>
                <a href="#" class="quick-link">ğŸ“š DocumentaciÃ³n</a>
                <a href="#" class="quick-link">ğŸ’» Tutoriales</a>
                <a href="#" class="quick-link">ğŸ“ Recursos</a>
                <a href="#" class="quick-link">â“ Preguntas</a>
            </div>
        </aside>
    </div>

    <!-- FOOTER -->
    <footer class="footer">
        <p>&copy; 2026 Social Network - Jhon Espinosa</p>
        <p>Construido con Grid | Flexbox | Float | Responsive Design</p>
    </footer>

    <!-- MODAL CÃMARA -->
    <div id="cameraModal" class="camera-modal">
        <div class="camera-container">
            <span class="camera-close">&times;</span>
            <h3>ğŸ“· Capturar Foto</h3>
            <div class="camera-wrapper">
                <video id="cameraStream" autoplay playsinline></video>
                <canvas id="photoCanvas" style="display: none;"></canvas>
            </div>
            <div class="camera-controls">
                <button id="captureBtn" class="camera-btn capture-btn">ğŸ“¸ Capturar</button>
                <button id="retakeBtn" class="camera-btn retake-btn" style="display: none;">ğŸ”„ Reintentar</button>
                <button id="usePhotoBtn" class="camera-btn use-btn" style="display: none;">âœ“ Usar Foto</button>
            </div>
        </div>
    </div>

    <!-- MODAL LIGHTBOX -->
    <div id="imageModal" class="modal">
        <span class="modal-close">&times;</span>
        <img class="modal-image" src="" alt="Imagen ampliada">
        <div class="modal-nav">
            <button class="modal-prev">â® Anterior</button>
            <button class="modal-next">Siguiente â¯</button>
        </div>
    </div>

    <!-- SCRIPT CÃMARA Y LIGHTBOX ROBUSTO -->
    <script>
        // ========== FUNCIONALIDAD DE CÃMARA ==========
        const cameraModal = document.getElementById('cameraModal');
        const cameraStream = document.getElementById('cameraStream');
        const photoCanvas = document.getElementById('photoCanvas');
        const cameraClose = document.querySelector('.camera-close');
        const cameraBtn = document.getElementById('cameraBtn');
        const captureBtn = document.getElementById('captureBtn');
        const retakeBtn = document.getElementById('retakeBtn');
        const usePhotoBtn = document.getElementById('usePhotoBtn');
        const galleryBtn = document.getElementById('galleryBtn');
        const galleryInput = document.getElementById('galleryInput');
        const publishBtn = document.getElementById('publishBtn');
        const postText = document.getElementById('postText');

        let stream = null;
        let capturedImage = null;
        let ctx = photoCanvas.getContext('2d');

        // Abrir cÃ¡mara
        cameraBtn.addEventListener('click', async () => {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: 'environment', width: { ideal: 1280 }, height: { ideal: 720 } }
                });
                cameraStream.srcObject = stream;
                cameraModal.style.display = 'flex';
                captureBtn.style.display = 'block';
                retakeBtn.style.display = 'none';
                usePhotoBtn.style.display = 'none';
                postText.value = '';
            } catch (error) {
                console.error('Error accediendo a cÃ¡mara:', error);
                alert('No se pudo acceder a la cÃ¡mara. Detalles: ' + error.message);
            }
        });

        // Capturar foto
        captureBtn.addEventListener('click', () => {
            photoCanvas.width = cameraStream.videoWidth;
            photoCanvas.height = cameraStream.videoHeight;
            ctx.drawImage(cameraStream, 0, 0);
            
            capturedImage = photoCanvas.toDataURL('image/jpeg', 0.9);
            
            // Mostrar preview
            cameraStream.style.display = 'none';
            photoCanvas.style.display = 'block';
            
            captureBtn.style.display = 'none';
            retakeBtn.style.display = 'block';
            usePhotoBtn.style.display = 'block';
        });

        // Reintentar
        retakeBtn.addEventListener('click', () => {
            cameraStream.style.display = 'block';
            photoCanvas.style.display = 'none';
            captureBtn.style.display = 'block';
            retakeBtn.style.display = 'none';
            usePhotoBtn.style.display = 'none';
            ctx.clearRect(0, 0, photoCanvas.width, photoCanvas.height);
        });

        // Usar foto capturada
        usePhotoBtn.addEventListener('click', () => {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
            cameraModal.style.display = 'none';
            cameraStream.style.display = 'block';
            photoCanvas.style.display = 'none';
            
            // Agregar foto al post actual
            createPostWithPhoto(capturedImage);
        });

        // Cerrar cÃ¡mara
        cameraClose.addEventListener('click', () => {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
            cameraModal.style.display = 'none';
            cameraStream.style.display = 'block';
            photoCanvas.style.display = 'none';
            captureBtn.style.display = 'block';
            retakeBtn.style.display = 'none';
            usePhotoBtn.style.display = 'none';
        });

        // GalerÃ­a
        galleryBtn.addEventListener('click', () => {
            galleryInput.click();
        });

        galleryInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    createPostWithPhoto(event.target.result);
                };
                reader.readAsDataURL(file);
            }
        });

        // Crear post con foto
        function createPostWithPhoto(imageDataUrl) {
            const postContent = postText.value || 'Â¡Compartiendo mi momento! ğŸ“¸';
            const now = new Date();
            const timeString = 'ahora';

            const newPost = document.createElement('article');
            newPost.className = 'post';
            newPost.innerHTML = `
                <div class="post-header">
                    <img src="imagenes/WhatsApp Image 2026-02-09 at 19.18.27.jpeg" alt="Tu perfil" class="profile-pic-small">
                    <div class="post-info">
                        <h4>Jhon Espinosa (TÃº)</h4>
                        <span class="post-time">${timeString}</span>
                    </div>
                    <span class="post-menu">â‹¯</span>
                </div>
                
                <div class="post-content">
                    <p>${postContent}</p>
                </div>

                <img src="${imageDataUrl}" alt="Foto capturada" class="post-image clickable-image" onerror="this.style.display='none';">

                <div class="post-stats">
                    <span>ğŸ‘ 0 me gusta</span>
                    <span>ğŸ’¬ 0 comentarios</span>
                    <span>â†—ï¸ 0 compartidos</span>
                </div>

                <div class="post-actions-footer">
                    <button class="action-btn">ğŸ‘ Me gusta</button>
                    <button class="action-btn">ğŸ’¬ Comentar</button>
                    <button class="action-btn">â†—ï¸ Compartir</button>
                </div>
            `;

            const feed = document.querySelector('.feed');
            const firstPost = feed.querySelector('.post');
            feed.insertBefore(newPost, firstPost);

            // Agregar evento click a la nueva imagen
            const newImage = newPost.querySelector('.clickable-image');
            if (newImage) {
                newImage.style.cursor = 'pointer';
                newImage.addEventListener('click', () => {
                    currentImageIndex = images.length;
                    modalImage.src = imageDataUrl;
                    modalImage.alt = 'Foto capturada';
                    modal.style.display = 'flex';
                });
                images.push({ src: imageDataUrl, alt: 'Foto capturada', element: newImage });
            }

            postText.value = '';
            alert('Â¡Post publicado exitosamente! ğŸ‰');
        }

        // ========== FUNCIONALIDAD LIGHTBOX ==========
        const modal = document.getElementById('imageModal');
        const modalImage = document.querySelector('.modal-image');
        const closeBtn = document.querySelector('.modal-close');
        const prevBtn = document.querySelector('.modal-prev');
        const nextBtn = document.querySelector('.modal-next');
        const clickableImages = document.querySelectorAll('.clickable-image');
        
        let currentImageIndex = 0;
        let images = [];

        function handleImageError(img) {
            console.warn('Error cargando imagen:', img.src);
            img.style.display = 'none';
        }

        function initImages() {
            images = Array.from(clickableImages)
                .filter(img => img.offsetHeight > 0)
                .map(img => ({
                    src: img.src,
                    alt: img.alt,
                    element: img
                }));
        }

        function preloadImage(src) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = () => resolve(src);
                img.onerror = () => reject(new Error('Error cargando: ' + src));
                img.src = src;
            });
        }

        clickableImages.forEach((img, index) => {
            img.style.cursor = 'pointer';
            img.addEventListener('click', async (e) => {
                e.stopPropagation();
                
                const imgIndex = images.findIndex(item => item.element === img);
                if (imgIndex === -1) return;
                
                currentImageIndex = imgIndex;
                
                try {
                    await preloadImage(images[currentImageIndex].src);
                    modalImage.src = images[currentImageIndex].src;
                    modalImage.alt = images[currentImageIndex].alt;
                    modal.style.display = 'flex';
                    document.body.style.overflow = 'hidden';
                } catch (error) {
                    console.error('No se pudo abrir la imagen:', error);
                }
            });
            
            img.addEventListener('error', () => handleImageError(img));
        });

        closeBtn.addEventListener('click', () => {
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
        });

        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });

        async function nextImage() {
            if (images.length === 0) return;
            currentImageIndex = (currentImageIndex + 1) % images.length;
            try {
                await preloadImage(images[currentImageIndex].src);
                modalImage.src = images[currentImageIndex].src;
                modalImage.alt = images[currentImageIndex].alt;
            } catch (error) {
                console.error('Error navegando:', error);
            }
        }

        async function prevImage() {
            if (images.length === 0) return;
            currentImageIndex = (currentImageIndex - 1 + images.length) % images.length;
            try {
                await preloadImage(images[currentImageIndex].src);
                modalImage.src = images[currentImageIndex].src;
                modalImage.alt = images[currentImageIndex].alt;
            } catch (error) {
                console.error('Error navegando:', error);
            }
        }

        nextBtn.addEventListener('click', nextImage);
        prevBtn.addEventListener('click', prevImage);

        document.addEventListener('keydown', (e) => {
            if (modal.style.display === 'flex') {
                if (e.key === 'ArrowRight') nextImage();
                if (e.key === 'ArrowLeft') prevImage();
                if (e.key === 'Escape') closeBtn.click();
            }
        });

        modalImage.addEventListener('error', () => {
            modalImage.src = 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="600" height="400"%3E%3Crect fill="%23cccccc" width="600" height="400"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="%23666" font-size="20"%3EImagen no disponible%3C/text%3E%3C/svg%3E';
        });

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initImages);
        } else {
            initImages();
        }

        window.addEventListener('load', initImages);

        // Cleanup de cÃ¡mara al cerrar pÃ¡gina
        window.addEventListener('beforeunload', () => {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
        });
    </script>
</body>
</html>
